---
title: "Data exploration for Heart diseases and common habits"
author: 
  - name: "Jose Daniel Trujillo Sandoval"
    orcid: "0009-0008-2978-2604"
    email: "jotr4809@colorado.edu"
    affiliation:
      - name: "University of Colorado Boulder"
        department: "Department of Civil, Environmental and Architectural Engineering"
        city: "Boulder"
        state: "CO"
        country: "USA"
date: today
format: 
  html:
    toc: true
    toc-depth: 2
editor: visual
execute:
  warning: false
---

------------------------------------------------------------------------

# Introduction

This project would focus on assessing habits related to heart diseases. The data set contains information of random patients, Systolic and Diastolic heart rates, Body mass index, height and weight, and common habits like drinking and smoking

# Methods

## Reading the Data

Loading Packages

```{r}
# Load Packages
library(tidyverse)
library(here) 
library(ggthemes)
# Read Data 
Cardiac_raw_data <- read.csv(here::here("data/raw/cardio_raw_data.csv"))
```

## Data Exploration Approach

```{r}

# Viewing the first rows 
head(Cardiac_raw_data) #Looks like everything is good at the first 7 rows
glimpse(Cardiac_raw_data) # Age: int, gender: chr, height: int, weight: dbl, Sys: int, dias: int, Cholesterol: chr, Glucose: chr, smoke: chr, alcohol: chr, physical: chr, disease: chr, bmi: dbl
tail(Cardiac_raw_data)

# Checking dimensions 
dim(Cardiac_raw_data) #68,675 rows, 13 colums 

# looking at ages 
Cardiac_raw_data |> 
  count(age) 

# looking at height
Cardiac_raw_data |> 
  count(height) 

# looking at weight
Cardiac_raw_data |> 
  count(weight) 

# Sumarise to see if there is any NA
Cardiac_raw_data |> 
  summarise(mean_age = mean(age),
            mean_height = mean(height),
            mean_weight = mean(weight),
            mean_systolic = mean(systolic),
            mean_diastolic = mean(diastolic),
            mean_bmi = mean(bmi)) #No NAs found 

#How many times each chr variable appers, and if there is any miswriting 
Cardiac_raw_data |>
  group_by(gender) |> # female 44,737 male 23,938  = 68,675 
  summarise(count = n())

Cardiac_raw_data |>
  group_by(cholesterol) |> #Extermely High 7,864 High 9,296 Normal 51,515 = 68,675 
  summarise(count = n())
  

Cardiac_raw_data |>
  group_by(glucose) |> # Extremely High 5,218 High 5,059 Normal 58,398 = 68,675
  summarise(count = n())

Cardiac_raw_data |>
  group_by(smoke) |> #NO 62,635 Yes 6,040 = 68,675
  summarise(count = n())

Cardiac_raw_data |>
  group_by(alcohol_intake) |> # No 65,007 Yes 3,668  = 68,675
  summarise(count = n())

Cardiac_raw_data |>
  group_by(physical_activity) |> #No 13,509 Yes 55,166 = 68,675
  summarise(count = n())

Cardiac_raw_data |>
  group_by(cv_disease) |> # No 34,724 Yes 33,951 = 68,675
  summarise(count = n())
```

## Initial Data Tidying

```{r}
#Creating vectors that would be converted into factors later 
Vector_yes_no <- c("Yes", "No") #This vector would be use into the Yes No answers for Smoking, alcohol, physical activity and cardiovascular disease 

Vector_levels_glu_and_cho <-  c("Extremely High", "High", "Normal") #This vector would be use for the answers in Cholesterol and glucose levels

Vector_gender <- c("Female", "Male") #this vector would be use into the gender answers 

# Creating the new tidied data set 
Tidied_cardiac_data <- Cardiac_raw_data |> 
  #Mutating from chr to factor
  mutate(gender_fct = factor(gender, levels = Vector_gender),
         cholesterol_fct = factor(cholesterol, levels = Vector_levels_glu_and_cho),
         glucose_fct = factor(glucose, levels= Vector_levels_glu_and_cho),
         smoke_fct = factor(smoke, levels = Vector_yes_no),
         alcohol_fct = factor(alcohol_intake, levels = Vector_yes_no),
         physical_activity_fct = factor(physical_activity, levels = Vector_yes_no),
         cv_disease_fct = factor(cv_disease, levels = Vector_yes_no)) |> 
  #Selecting the new column factors and numeric variables
  select(age, 
         gender_fct, 
         height, 
         weight, 
         systolic, 
         diastolic, 
         cholesterol_fct, 
         glucose_fct, 
         smoke_fct, 
         alcohol_fct, 
         physical_activity_fct, 
         cv_disease_fct, 
         bmi) |> 
  #Renaming the colums 
  rename(gender = gender_fct,
         cholesterol = cholesterol_fct,
         glucose = glucose_fct,
         smoke = smoke_fct,
         alcohol_intake = alcohol_fct,
         physical_act= physical_activity_fct,
         Cardiovascular_disease = cv_disease_fct) |> 
  #Relocating bmi after diastolic 
  relocate(bmi, .after = diastolic)

#Saving results 
write_csv(Tidied_cardiac_data, here::here("data/processed/tidied_Cardiac_data.csv"))
```

Data visualization.

First of All, we will read the tidied dataset that we created in the previous section.

```{r}
Tidied_cardiac_data <- read.csv(here::here("data/processed/tidied_Cardiac_data.csv"))
```

In this part, we show the visualization of the data set in terms of relevant information. Regarding the information of this tidied data set, we would look for information that says if there is any relation between High pressure (over 130/80 mmHg) and the presence of Cholesterol and CardioVascular disease.

Which set of group its more likely to have cardiovascular disease at a certain age.

Relation between BMI and level of glucose.

a Cardiac disease with the intake of alcohol, smoking and physical activity.

High Pressure vs Cholesterol and Cardiovascular disease.

```{r}

High_Pressure_Cholesterol_CV_disease<- Tidied_cardiac_data |> 
  select(systolic, diastolic, cholesterol, Cardiovascular_disease) |> 
  filter(systolic >= 130 & diastolic >= 80) |> 
  mutate(High_Pressure = (systolic + diastolic) / 2)


ggplot(data = High_Pressure_Cholesterol_CV_disease, 
       mapping = aes(x = cholesterol,
                     y = High_Pressure, 
                     fill= Cardiovascular_disease)) + 
  geom_boxplot(outlier.shape = NA) +
  scale_y_continuous(breaks = seq(100, 145, 5), limits = c(100, 145)) +
  scale_fill_brewer(type = "qual", palette = 5) +
  labs(title = "Hypertension and Cholesterol and Cardiovascular diseases",
       subtitle = "Prevalence of cardiovascular disease in individuals with levels of cholesterol and blood pressure",
       x = "Cholesterol levels",
       y = "High blood pressure (mean mmHg)",
       fill = "Cardiovascular diseases",
       caption = "Data: Tidied Cardiac dataset."
  ) +
  theme_minimal(base_size = 11) 

```

Age and Cardiovascular disease.

```{r}
cv_disease_age <- Tidied_cardiac_data |> 
  select(age, Cardiovascular_disease) 
  
ggplot(data = cv_disease_age,
       mapping = aes(x = age,
                     fill = Cardiovascular_disease)) +
  geom_histogram(col = "grey30",
                 breaks = seq(30, 70, 2)) +
  scale_fill_brewer(type = "qual", palette = 5) +
  scale_y_continuous(breaks = seq(0, 7500, 1000), limits = c(0, 7500)) +
  labs(title = "Age and Cardiovascular diseases",
       subtitle = "Prevalence of Cardiovascular Disease Across Age Groups",
       x = "Age groups (2 years)",
       y = "Number of people",
       fill = "Cardiovascular diseases",
       caption = "Data: Tidied Cardiac dataset."
  ) +
  theme_minimal(base_size = 11) 

```

# Results

\[This will be the core of your analysis with specific requirements\]

# Conclusions

## Summary of Findings

## Questions and Next Steps
