---
title: "Data exploration for Heart diseases and common habits"
author: 
  - name: "Jose Daniel Trujillo Sandoval"
    orcid: "0009-0008-2978-2604"
    email: "jotr4809@colorado.edu"
    affiliation:
      - name: "University of Colorado Boulder"
        department: "Department of Civil, Environmental and Architectural Engineering"
        city: "Boulder"
        state: "CO"
        country: "USA"
date: today
format: 
  html:
    toc: true
    toc-depth: 2
editor: visual
execute:
  warning: false
---

------------------------------------------------------------------------

# Introduction

This project would focus on assessing habits related to heart diseases. The data set contains information of random patients, Systolic and Diastolic heart rates, Body mass index, height and weight, and common habits like drinking and smoking

# Methods

## Reading the Data

Loading Packages

```{r}
# Load Packages
library(tidyverse)
library(here) 
library(ggthemes)
# Read Data 
Cardiac_raw_data <- read.csv(here::here("data/raw/cardio_raw_data.csv"))
```

## Data Exploration Approach

```{r}

# Viewing the first rows 
head(Cardiac_raw_data) #Looks like everything is good at the first 7 rows
glimpse(Cardiac_raw_data) # Age: int, gender: chr, height: int, weight: dbl, Sys: int, dias: int, Cholesterol: chr, Glucose: chr, smoke: chr, alcohol: chr, physical: chr, disease: chr, bmi: dbl
tail(Cardiac_raw_data)

# Checking dimensions 
dim(Cardiac_raw_data) #68,675 rows, 13 colums 

# looking at ages 
Cardiac_raw_data |> 
  count(age) 

# looking at height
Cardiac_raw_data |> 
  count(height) 

# looking at weight
Cardiac_raw_data |> 
  count(weight) 

# Sumarise to see if there is any NA
Cardiac_raw_data |> 
  summarise(mean_age = mean(age),
            mean_height = mean(height),
            mean_weight = mean(weight),
            mean_systolic = mean(systolic),
            mean_diastolic = mean(diastolic),
            mean_bmi = mean(bmi)) #No NAs found 

#How many times each chr variable appers, and if there is any miswriting 
Cardiac_raw_data |>
  group_by(gender) |> # female 44,737 male 23,938  = 68,675 
  summarise(count = n())

Cardiac_raw_data |>
  group_by(cholesterol) |> #Extermely High 7,864 High 9,296 Normal 51,515 = 68,675 
  summarise(count = n())
  

Cardiac_raw_data |>
  group_by(glucose) |> # Extremely High 5,218 High 5,059 Normal 58,398 = 68,675
  summarise(count = n())

Cardiac_raw_data |>
  group_by(smoke) |> #NO 62,635 Yes 6,040 = 68,675
  summarise(count = n())

Cardiac_raw_data |>
  group_by(alcohol_intake) |> # No 65,007 Yes 3,668  = 68,675
  summarise(count = n())

Cardiac_raw_data |>
  group_by(physical_activity) |> #No 13,509 Yes 55,166 = 68,675
  summarise(count = n())

Cardiac_raw_data |>
  group_by(cv_disease) |> # No 34,724 Yes 33,951 = 68,675
  summarise(count = n())
```

## Initial Data Tidying

```{r}
#Creating vectors that would be converted into factors later 
Vector_yes_no <- c("Yes", "No") #This vector would be use into the Yes No answers for Smoking, alcohol, physical activity and cardiovascular disease 

Vector_levels_glu_and_cho <-  c("Extremely High", "High", "Normal") #This vector would be use for the answers in Cholesterol and glucose levels

Vector_gender <- c("Female", "Male") #this vector would be use into the gender answers 

# Creating the new tidied data set 
Tidied_cardiac_data <- Cardiac_raw_data |> 
  #Mutating from chr to factor
  mutate(gender_fct = factor(gender, levels = Vector_gender),
         cholesterol_fct = factor(cholesterol, levels = Vector_levels_glu_and_cho),
         glucose_fct = factor(glucose, levels= Vector_levels_glu_and_cho),
         smoke_fct = factor(smoke, levels = Vector_yes_no),
         alcohol_fct = factor(alcohol_intake, levels = Vector_yes_no),
         physical_activity_fct = factor(physical_activity, levels = Vector_yes_no),
         cv_disease_fct = factor(cv_disease, levels = Vector_yes_no)) |> 
  #Selecting the new column factors and numeric variables
  select(age, 
         gender_fct, 
         height, 
         weight, 
         systolic, 
         diastolic, 
         cholesterol_fct, 
         glucose_fct, 
         smoke_fct, 
         alcohol_fct, 
         physical_activity_fct, 
         cv_disease_fct, 
         bmi) |> 
  #Renaming the colums 
  rename(gender = gender_fct,
         cholesterol = cholesterol_fct,
         glucose = glucose_fct,
         smoke = smoke_fct,
         alcohol_intake = alcohol_fct,
         physical_act= physical_activity_fct,
         Cardiovascular_disease = cv_disease_fct) |> 
  #Relocating bmi after diastolic 
  relocate(bmi, .after = diastolic)

#Saving results 
write_csv(Tidied_cardiac_data, here::here("data/processed/tidied_Cardiac_data.csv"))
```

Data visualization.

First of All, we will read the tidied dataset that we created in the previous section.

```{r}
Tidied_cardiac_data <- read.csv(here::here("data/processed/tidied_Cardiac_data.csv"))
```

In this section, we present visualizations of the dataset focused on extracting relevant insights. Specifically, we aim to explore whether there is a relationship between high blood pressure (defined as values above 130/80 mmHg), cholesterol levels, and the presence of cardiovascular disease (CVD).

Additionally, we seek to answer the question of which age groups have more cardiovascular disease, based on the available data.

Finally, we examine the prevalence of cardiovascular disease in relation to lifestyle factors, such as alcohol consumption, smoking, and physical activity.

**Hypertension vs Cholesterol levels and Cardiovascular diseases.**

```{r}

High_Pressure_Cholesterol_CV_disease<- Tidied_cardiac_data |> 
  select(systolic, diastolic, cholesterol, Cardiovascular_disease) |> 
  filter(systolic >= 130 & diastolic >= 80) |> 
  mutate(High_Pressure = (systolic + diastolic) / 2)


ggplot(data = High_Pressure_Cholesterol_CV_disease, 
       mapping = aes(x = cholesterol,
                     y = High_Pressure, 
                     fill= Cardiovascular_disease)) + 
  geom_boxplot(outlier.shape = NA) +
  scale_y_continuous(breaks = seq(100, 145, 5), limits = c(100, 145)) +
  scale_fill_brewer(type = "qual", palette = 5) +
  labs(title = "Hypertension and Cholesterol and Cardiovascular diseases",
       subtitle = "Prevalence of cardiovascular disease in individuals with levels of cholesterol and blood pressure",
       x = "Cholesterol levels",
       y = "High blood pressure (mean mmHg)",
       fill = "Cardiovascular diseases",
       caption = "Data: Tidied Cardiac dataset."
  ) +
  theme_minimal(base_size = 11) 

```

Figure 1 presents a visualization comparing groups of individuals with extremely high, high, and normal cholesterol levels, distinguishing between those with and without cardiovascular disease (CVD). The dataset has been filtered to include only individuals with hypertension, defined as having an average systolic blood pressure above 130 mmHg and diastolic blood pressure above 80 mmHg.

The figure uses a boxplot to display the distribution of mean blood pressure across the different cholesterol level groups, highlighting the average values, identifying outliers, and illustrating the prevalence of CVD within each group.

From the chart, we observe that individuals with high and normal cholesterol levels tend to have higher blood pressure if they also have cardiovascular disease, compared to those without CVD. Notably, these groups also show a higher average blood pressure, around 115 mmHg, among individuals with CVD, while those without CVD have a lower mean of approximately 110 mmHg.

In contrast, for the group with extremely high cholesterol levels, there is no significant difference in mean blood pressure between individuals with and without CVD; both subgroups show an average close to 115 mmHg.

**Age distribution and Cardiovascular disease.**

```{r}
cv_disease_age <- Tidied_cardiac_data |> 
  select(age, Cardiovascular_disease) 
  
ggplot(data = cv_disease_age,
       mapping = aes(x = age,
                     fill = Cardiovascular_disease)) +
  geom_histogram(col = "grey30",
                 breaks = seq(30, 70, 2)) +
  scale_fill_brewer(type = "qual", palette = 5) +
  scale_y_continuous(breaks = seq(0, 7500, 1000), limits = c(0, 7500)) +
  labs(title = "Age and Cardiovascular diseases",
       subtitle = "Prevalence of Cardiovascular Disease Across Age Groups",
       x = "Age groups (2 years)",
       y = "Number of people",
       fill = "Cardiovascular diseases",
       caption = "Data: Tidied Cardiac dataset."
  ) +
  theme_minimal(base_size = 11) 

```

Figure 2 presents a histogram illustrating the age distribution of the population, grouped in two-year intervals, starting from 38 years old and ending at 66 years old. The chart also differentiates between individuals with and without cardiovascular disease (CVD): light green bars represent people without CVD, while light orange bars represent those with CVD.

The distribution of both groups follows a pattern similar to a Gaussian bell curve, with a noticeable peak in the 56–58 age range. This visualization provides key insights: overall, we can observe that younger individuals are less likely to have CVD, whereas the prevalence of CVD increases with age, reaching almost 80% in the 65–66 age group.

**Cardiac disease with the intake of alcohol, smoking and physical activity.**

```{r}
bad_habits <- Tidied_cardiac_data |> 
  select(alcohol_intake, smoke, physical_act, Cardiovascular_disease) |> 
  group_by(alcohol_intake, smoke, physical_act, Cardiovascular_disease) |>
  rename(alcohol = alcohol_intake,
         smoking = smoke, 
         Exercising = physical_act) |> 
  pivot_longer(c("alcohol", "smoking", "Exercising"), names_to = "Habit", values_to = "Y_o_N")



ggplot(data = bad_habits,
       mapping = aes(x = Cardiovascular_disease, 
                     fill = Y_o_N)) +
  geom_bar() +
  facet_wrap(~Habit) +
  scale_size(range = c(2, 12)) +
  scale_y_continuous(breaks = seq(0, 40000, 10000), limits = c(0, 40000)) +
  scale_fill_brewer(type = "qual", palette = 5) +
  labs(title = "Cardiovascular disease regarding unhealthy lifestyle habits",
       subtitle = "presence of Cardiovascular across Alcohol, smoking and physical activity",
       x = "Presence of Cardiovascular diseases",
       y = "Number of people",
       fill = "Prevalence of
Unhealthy Lifestyle
Habits",
       caption = "Data: Tidied Cardiac dataset."
  ) +
  theme_minimal(base_size = 11) 

```

Figure 3 is a grouped bar chart displaying the frequency of individuals engaging in unhealthy habits such as alcohol consumption, lack of physical activity, and smoking. The x-axis represents the presence or absence of cardiovascular disease (CVD), while the bar colors indicate whether or not the individual engages in the activity: light green for *No* and light orange for *Yes*.

Regarding alcohol consumption, the data shows that very few individuals engage in this habit, regardless of whether they have CVD or not. In terms of physical activity, both groups, those with and without CVD, show a high prevalence of regular exercise. Finally, in the case of smoking, only a small portion of individuals in either group report smoking, though this number is slightly higher than that for alcohol consumption.

# Results

\[This will be the core of your analysis with specific requirements\]

# Conclusions

## Summary of Findings

## Questions and Next Steps
